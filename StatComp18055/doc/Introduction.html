<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Dandan Liu" />

<meta name="date" content="2019-01-11" />

<title>Introduction to StatComp18055</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp18055</h1>
<h4 class="author"><em>Dandan Liu</em></h4>
<h4 class="date"><em>2019-01-11</em></h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>StatComp18055</strong> is a simple R package which includes four R functions for the ‘Statistical Computing’ course: <em>CVM.test</em> (test for equal distributions in the univariate case), <em>my.pcauchy</em> (compute the cdf of the Cauchy distribution), <em>my.chisq.test</em>(a faster version of chisq.test() that only computes the chi-square test statistic when the input is two numeric vectors with no missing values) and <em>my.table</em>(a faster version of table() for the case of an input of two integer vectors with no missing values).</p>
<p>The R package ‘microbenchmark’ can be used to benchmark the functions <em>my.chisq.test</em> and <em>my.table</em>.</p>
</div>
<div id="cvm.test" class="section level2">
<h2><em>CVM.test</em></h2>
<p>The function CVM.test() chooses Cramer-von Mises statistic to measure the difference between two distributions and tests for equal distributions in the univariate case. The source R code for <em>CVM.test</em> is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CVM.test &lt;-<span class="st"> </span><span class="cf">function</span>(x,y,R) {
  CVM.stat &lt;-<span class="st"> </span><span class="cf">function</span>(x,y) {
    n &lt;-<span class="st"> </span><span class="kw">length</span>(x)
    m &lt;-<span class="st"> </span><span class="kw">length</span>(y)
    F_n &lt;-<span class="st"> </span><span class="kw">ecdf</span>(x)
    G_m &lt;-<span class="st"> </span><span class="kw">ecdf</span>(y)
    T &lt;-<span class="st"> </span>((m<span class="op">*</span>n)<span class="op">/</span>(m<span class="op">+</span>n)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(<span class="kw">sum</span>((<span class="kw">F_n</span>(x)<span class="op">-</span><span class="kw">G_m</span>(x))<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>((<span class="kw">F_n</span>(y)<span class="op">-</span><span class="kw">G_m</span>(y))<span class="op">^</span><span class="dv">2</span>)) <span class="co"># the Cramer-Von Mises (CVM) statistic</span>
    <span class="kw">return</span>(T)
  } <span class="co"># use Cramer-von Mises statistic to measure the difference between two distributions</span>
  n1 &lt;-<span class="st"> </span><span class="kw">length</span>(x)
  n2 &lt;-<span class="st"> </span><span class="kw">length</span>(y)
  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2
  z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) <span class="co"># pooled sample</span>
  K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n
  reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R) <span class="co"># storage for replicates</span>
  t0 &lt;-<span class="st"> </span><span class="kw">CVM.stat</span>(x,y) <span class="co"># the observed statistic t0</span>
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) { <span class="co"># permutation samples</span>
    k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)
    x1 &lt;-<span class="st"> </span>z[k]
    y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co"># complement of x1</span>
    reps[i] &lt;-<span class="st"> </span><span class="kw">CVM.stat</span>(x1, y1) <span class="co"># the Cramer-Von Mises (CVM) statistic T</span>
  }
  p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(t0, reps) <span class="op">&gt;=</span><span class="st"> </span>t0)
  <span class="kw">print</span>(p)
}</code></pre></div>
<p>We can apply the test to the data in Examples 8.1 and 8.2(Statistical Computing with R):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># obtain data</span>
<span class="kw">attach</span>(chickwts)
x &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;soybean&quot;</span>]))
y &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;linseed&quot;</span>]))
<span class="kw">detach</span>(chickwts)
<span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">CVM.test</span>(x,y,<span class="dt">R=</span><span class="dv">999</span>)</code></pre></div>
<pre><code>## [1] 0.421</code></pre>
<p>The value of p we obtained is 0.421, so the null hypothesis that distributions are equal is not rejected.</p>
</div>
<div id="my.pcauchy" class="section level2">
<h2><em>my.pcauchy</em></h2>
<p>The function my.pcauchy() computes the cdf of the Cauchy distribution. The source R code for <em>my.pcauchy</em> is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.pcauchy &lt;-<span class="st"> </span><span class="cf">function</span> (x, eta, theta) {
  <span class="kw">stopifnot</span>(theta <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)
  my.dcauchy &lt;-<span class="st"> </span><span class="cf">function</span> (x, eta, theta) {
    <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>(theta<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>((x <span class="op">-</span><span class="st"> </span>eta)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>)))
  } <span class="co"># the density function of the Cauchy distribution</span>
  integral &lt;-<span class="st"> </span><span class="cf">function</span> (x) {
    <span class="kw">my.dcauchy</span>(x, eta, theta)
  }
  <span class="kw">return</span>(<span class="kw">integrate</span>(integral, <span class="dt">lower =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">upper =</span> x, <span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>)<span class="op">$</span>value)
} <span class="co"># the value of the integrand is the cdf of the Cauchy distribution</span></code></pre></div>
<p>We can compare our results obtained by my.pcauchy() to the results obtained by the R function pcauchy():</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Cauchy(0,1)</span>
xs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">5</span>)
<span class="kw">names</span>(xs) &lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">5</span>))
my.pcauchy.val &lt;-<span class="st"> </span><span class="kw">sapply</span>(xs, <span class="cf">function</span>(x) <span class="kw">my.pcauchy</span>(x, <span class="dv">0</span>, <span class="dv">1</span>))
pcauchy.val &lt;-<span class="st"> </span><span class="kw">sapply</span>(xs, <span class="cf">function</span>(x) <span class="kw">pcauchy</span>(x, <span class="dv">0</span>, <span class="dv">1</span>))
<span class="kw">round</span>(<span class="kw">rbind</span>(<span class="dt">my.pcauchy=</span>my.pcauchy.val, <span class="dt">pcauchy=</span>pcauchy.val), <span class="dv">4</span>)</code></pre></div>
<pre><code>##               -4     -3     -2   -1   0    1      2      3     4      5
## my.pcauchy 0.078 0.1024 0.1476 0.25 0.5 0.75 0.8524 0.8976 0.922 0.9372
## pcauchy    0.078 0.1024 0.1476 0.25 0.5 0.75 0.8524 0.8976 0.922 0.9372</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Cauchy(1,2)</span>
my.pcauchy.val &lt;-<span class="st"> </span><span class="kw">sapply</span>(xs, <span class="cf">function</span>(x) <span class="kw">my.pcauchy</span>(x, <span class="dv">1</span>, <span class="dv">2</span>))
pcauchy.val &lt;-<span class="st"> </span><span class="kw">sapply</span>(xs, <span class="cf">function</span>(x) <span class="kw">pcauchy</span>(x, <span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">round</span>(<span class="kw">rbind</span>(<span class="dt">my.pcauchy=</span>my.pcauchy.val, <span class="dt">pcauchy=</span>pcauchy.val), <span class="dv">4</span>)</code></pre></div>
<pre><code>##                -4     -3     -2   -1      0   1      2    3      4      5
## my.pcauchy 0.1211 0.1476 0.1872 0.25 0.3524 0.5 0.6476 0.75 0.8128 0.8524
## pcauchy    0.1211 0.1476 0.1872 0.25 0.3524 0.5 0.6476 0.75 0.8128 0.8524</code></pre>
<p>Setting different parameters of Cauchy distribution and comparing the results obtained by my.pcauchy() to the results obtained by pcauchy(), we can clearly find that the two results are identical. So the function we write is reasonable.</p>
</div>
<div id="my.chisq.test" class="section level2">
<h2><em>my.chisq.test</em></h2>
<p>The function my.chisq.test() is a faster version of chisq.test() that only computes the chi-square test statistic when the input is two numeric vectors with no missing values. The source R code for <em>my.chisq.test</em> is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.chisq.test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {
  total &lt;-<span class="st"> </span><span class="kw">sum</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(y)
  rowsum_x &lt;-<span class="st"> </span><span class="kw">sum</span>(x)
  rowsum_y &lt;-<span class="st"> </span><span class="kw">sum</span>(y)
  chistat &lt;-<span class="st"> </span><span class="dv">0</span>
  expected &lt;-<span class="st"> </span><span class="cf">function</span>(colsum, rowsum, total) {
    (colsum <span class="op">/</span><span class="st"> </span>total) <span class="op">*</span><span class="st"> </span>(rowsum <span class="op">/</span><span class="st"> </span>total) <span class="op">*</span><span class="st"> </span>total
  } <span class="co"># the expected (theoretical) count of type i</span>
  chi_stat &lt;-<span class="st"> </span><span class="cf">function</span>(observed, expected) {
    ((observed <span class="op">-</span><span class="st"> </span>expected) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>expected
  } <span class="co"># a measure of the approximation between observed value and expected value</span>
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {
    colsum &lt;-<span class="st"> </span>x[i] <span class="op">+</span><span class="st"> </span>y[i]
    expected_x &lt;-<span class="st"> </span><span class="kw">expected</span>(colsum, rowsum_x, total)
    expected_y &lt;-<span class="st"> </span><span class="kw">expected</span>(colsum, rowsum_y, total)
    chistat &lt;-<span class="st"> </span>chistat <span class="op">+</span><span class="st"> </span><span class="kw">chi_stat</span>(x[i], expected_x)
    chistat &lt;-<span class="st"> </span>chistat <span class="op">+</span><span class="st"> </span><span class="kw">chi_stat</span>(y[i], expected_y)
  }
  chistat
} <span class="co"># code from the mathematical definition</span></code></pre></div>
<p>We can apply the test to the data in Examples7.4.5(Probability Theory and Mathematical Statistics):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">my.chisq.test</span>(<span class="kw">c</span>(<span class="dv">367</span>,<span class="dv">342</span>,<span class="dv">266</span>,<span class="dv">329</span>),<span class="kw">c</span>(<span class="dv">56</span>,<span class="dv">40</span>,<span class="dv">20</span>,<span class="dv">16</span>))</code></pre></div>
<pre><code>## [1] 19.27727</code></pre>
<p>We can compare our results obtained by my.chisq.test() to the results obtained by the R function chisq.test():</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># validate the function my.chisq.test() is reasonable</span>
<span class="kw">chisq.test</span>(<span class="kw">as.table</span>(<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">367</span>,<span class="dv">342</span>,<span class="dv">266</span>,<span class="dv">329</span>),<span class="kw">c</span>(<span class="dv">56</span>,<span class="dv">40</span>,<span class="dv">20</span>,<span class="dv">16</span>))))</code></pre></div>
<pre><code>## 
##  Pearson's Chi-squared test
## 
## data:  as.table(rbind(c(367, 342, 266, 329), c(56, 40, 20, 16)))
## X-squared = 19.277, df = 3, p-value = 0.0002396</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Validate the function my.chisq.test() is faster than chisq.test()</span>
<span class="kw">print</span>(microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(
  <span class="dt">my.chisq.test =</span> <span class="kw">my.chisq.test</span>(<span class="kw">c</span>(<span class="dv">367</span>,<span class="dv">342</span>,<span class="dv">266</span>,<span class="dv">329</span>),<span class="kw">c</span>(<span class="dv">56</span>,<span class="dv">40</span>,<span class="dv">20</span>,<span class="dv">16</span>)),
  <span class="dt">chisq.test =</span> <span class="kw">chisq.test</span>(<span class="kw">as.table</span>(<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">367</span>,<span class="dv">342</span>,<span class="dv">266</span>,<span class="dv">329</span>),<span class="kw">c</span>(<span class="dv">56</span>,<span class="dv">40</span>,<span class="dv">20</span>,<span class="dv">16</span>))))
))</code></pre></div>
<pre><code>## Unit: microseconds
##           expr     min      lq      mean   median       uq     max neval
##  my.chisq.test  15.823  17.106  20.34796  18.1760  21.8110  42.338   100
##     chisq.test 232.640 237.771 254.09451 241.8335 267.2785 398.566   100</code></pre>
<p>From the results above, we can find that: when the input is two numeric vectors with no missing values, the function my.chisq.test() can get the same chi-squared test statistic value as chisq.test(), and my.chisq.test() only computes the chi-square test statistic. Using the microbenchmark package to compare how long each function takes to run, we can find that my.chisq.test() is obviously faster than chisq.test().</p>
</div>
<div id="my.table" class="section level2">
<h2><em>my.table</em></h2>
<p>The function my.table() is a faster version of table() for the case of an input of two integer vectors with no missing values. The source R code for <em>my.table</em> is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.table &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {
  x_unique &lt;-<span class="st"> </span><span class="kw">unique</span>(x) <span class="co"># extract unique elements of x</span>
  y_unique &lt;-<span class="st"> </span><span class="kw">unique</span>(y) <span class="co"># extract unique elements of y</span>
  mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(0L, <span class="kw">length</span>(x_unique), <span class="kw">length</span>(y_unique)) <span class="co"># storage for replicates</span>
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {
    mat[<span class="kw">which</span>(x_unique <span class="op">==</span><span class="st"> </span>x[[i]]), <span class="kw">which</span>(y_unique <span class="op">==</span><span class="st"> </span>y[[i]])] &lt;-
<span class="st">      </span>mat[<span class="kw">which</span>(x_unique <span class="op">==</span><span class="st"> </span>x[[i]]),  <span class="kw">which</span>(y_unique <span class="op">==</span><span class="st"> </span>y[[i]])] <span class="op">+</span><span class="st"> </span>1L
  } <span class="co"># build a contingency table of the counts at each combination of factor levels</span>
  <span class="co"># optimize the form of output</span>
  dimnames &lt;-<span class="st"> </span><span class="kw">list</span>(x_unique, y_unique)
  <span class="kw">names</span>(dimnames) &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">as.list</span>(<span class="kw">match.call</span>())[<span class="op">-</span><span class="dv">1</span>])
  tab &lt;-<span class="st"> </span><span class="kw">array</span>(mat, <span class="dt">dim =</span> <span class="kw">dim</span>(mat), <span class="dt">dimnames =</span> dimnames)
  <span class="kw">class</span>(tab) &lt;-<span class="st"> &quot;table&quot;</span>
  tab
}</code></pre></div>
<p>We can use an example to compare our results obtained by my.table() to the results obtained by the R function table():</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)
<span class="co"># validate the function my.table() is reasonable</span>
<span class="kw">my.table</span>(x, y)</code></pre></div>
<pre><code>##    y
## x   1 2
##   1 2 0
##   2 1 2
##   3 3 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(x, y)</code></pre></div>
<pre><code>##    y
## x   1 2
##   1 2 0
##   2 1 2
##   3 3 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># validate the function my.table() is faster than table()</span>
<span class="kw">print</span>(microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(
  <span class="dt">my.table =</span> <span class="kw">my.table</span>(x, y),
  <span class="dt">table =</span> <span class="kw">table</span>(x, y)
))</code></pre></div>
<pre><code>## Unit: microseconds
##      expr     min      lq      mean  median       uq      max neval
##  my.table  62.009  68.851  77.41285  75.694  83.1775  130.432   100
##     table 180.039 195.862 234.58530 216.175 232.2120 1220.927   100</code></pre>
<p>From the results above, we can find that: when the input is two integer vectors with no missing values, the function my.table() can get the same contingency table as table(). Using the microbenchmark package to compare how long each function takes to run, we can find that my.table() is obviously faster than table().</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
